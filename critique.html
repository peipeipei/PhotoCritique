<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="photopage.css">
    <link rel="stylesheet" type="text/css" href="critique.css">
        <link href='http://fonts.googleapis.com/css?family=Redressed' rel='stylesheet' type='text/css'>
    <title>Critique for Bunny and Chicks</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Quattrocento+Sans' rel='stylesheet' type='text/css'>
    
    
    <script type="text/javascript">

    	$(document).ready(function(){
            var offsetLeft = $("#photo").offset().left;
            var offsetTop = $("#photo").offset().top;
            var current_id = 4;

        $("#image").on("click", function(e){
            if ($("#annotate").hasClass("active")){
                current_id++;
                var img = document.createElement("img");
                img.id = "img_" + current_id;
                img.src = "circle.png";
                var w = img.width;

                // center image on mouse click
                xPos = e.pageX - offsetLeft - w/2;
                yPos = e.pageY - offsetTop - w/2;

                img.style.position = "absolute"
                img.style.left = xPos + "px";
                img.style.top = yPos + "px";

                $("#photo").append(img);

                var comment = document.createElement("div");
                $(comment).addClass("comment");
                comment.id = "comment_" + current_id;

                var textarea = document.createElement("textarea");
                textarea.id = "text_" + current_id;
                $(comment).append(textarea);

                var post_comment = "<button class = 'post' id = 'post_" + current_id + "'>Post Comment</button>"
                var cancel = "<button class = 'cancel' id = 'cancel_" + current_id + "'>Cancel</button>"

                $(comment).append(post_comment);
                $(comment).append(cancel);

                $("#comments").append(comment);

                $("#annotate").removeClass("active");
                $(document.body).css({'cursor' : 'default'});  
            }
            //window.location="critique2.html"
        })

        $(document).on("click", ".cancel", function() {
            var id = this.id.substring(7);
            $("#img_" + id).remove();
            $("#comment_" + id).remove();
            current_id--;
        })

        $(document).on("click", ".post", function() {
            var id = this.id.substring(5);
            var msg = $("#text_" + id).val();
            $("#comment_" + id).remove();

           var comment = document.createElement("div");
            $(comment).addClass("comment");
            comment.id = "comment_" + current_id;

            $(comment).append(msg);

            $("#comments").append(comment);
            $(comment).addClass("active");

        })

    	$(document).on("click", ".comment", function(){
    		var id = this.id
    		$('.comment').each(function(i, obj) {
    			photo_id = obj.id.substring(8);
    			if (id === obj.id){
    				$("#" + obj.id).addClass("active");

                    if (photo_id < 4){
    				    $("#image").attr("src", "annotated_photos/cute-animals-group" + photo_id + ".jpg")
                    }
    			}
    			else {
    				$("#" + obj.id).removeClass("active");
    			}
			});
    	})

        $("#annotate").on("click", function(){
            if ($(this).hasClass("active")){
                $(this).removeClass("active");
                $(document.body).css({'cursor' : 'default'});     
            }
            else {
                $(this).addClass("active");
                $(document.body).css({'cursor' : 'url("circle.png"), auto'});     
            }
        })

    	})
    </script>
</head>
<body>
   <nav class="navbar navbar-default" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>    
        </div>
            <a class="navbar-brand" href="#">Aperature</a>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-left">
                <li><a href="#" class="glyphicon glyphicon-globe" title="Explore"></a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#" class="glyphicon glyphicon-user" title="Your Profile">Username</a></li>
                <li><a href="#" class="glyphicon glyphicon-inbox" title="Inbox"></a></li>
                <li><a href="#" class="glyphicon glyphicon-cloud-upload" title="Upload"></a></li>
            </ul>
        </div>
    </nav>
    
<div id = "container">
    <div style="border-bottom: 2px solid #b2cc3c; color: #FF4242;">
    <h2>Critiquer: pikachu</h2>
</div>
<div id = "photo">
	<h3>Bunny and Chicks</h3>
    <img id = "image" src="annotated_photos/cute-animals-group1.jpg" style="width:512px;"/>
    <div><button id = "annotate" class = "btn btn-default" title = "Add annotation"><img src="circle.png"></button>
    <button id = "group" class = "btn btn-default"  title = "Group circles"><img src="circle-group.png"></button></div>
</div>
<div id = "comments">
	<h3>Focal Points</h3>
	<div class = "comment active" id="comment_1">
		These areas are in the shadow and I think they would look better if they were in light.
	</div>
	<div class = "comment" id = "comment_2">
		Great focus! I love how the whiskers and fur stand out!
	</div>
	<div class = "comment" id = "comment_3">
		I like how the background is blurred so the animals stand out.
	</div>
</div>
</div>


</body>
</html>